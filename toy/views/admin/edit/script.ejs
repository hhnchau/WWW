<script>
    document.location.hash = encodeURIComponent("do#choi#tre#em#kingpes#new#edit#product.html");
</script>
<script>
    var data = {}
    //Add Sn
    '<%if (lstSn != undefined){%>'
    '<% lstSn.forEach(function(item, index){%>';
    data['<%-item.sn%>'] = null;
    '<%})%>'
    '<%}%>'
    // Autocomplete
    const ac = document.querySelector('.autocomplete');
    M.Autocomplete.init(ac, {
        data
    });
</script>

<!-- Enter -->
<script>
    $('#search-input').keydown(function (e) {
        if (e.keyCode == 13) {
            search = $('#search-input').val();
            if (search != "") {
                $("#search-input").val('');

                window.location.href = 'admin/edit-product?filter=' + search;

            }
        }
    })
</script>

<script>
    $('#btn-finish').on('click', function () {
        if ($('#sn').val() == "")
            return alert('Vui lòng nhập mã sản phẩm');
        if ($('#name').val() == "")
            return alert('Vui lòng nhập tên sản phẩm');
        if ($('#link').val() == "")
            //return alert('Vui lòng nhập giá');
        if ($("#category").val() == "")
            return alert('Vui lòng nhập danh mục');
        // if ($("#video").val() == "")
        //     return alert('Vui lòng nhập link video');

        var product = {
            sn: $('#sn').val(),
            name: $('#name').val(),
            link: $('#link').val(),
            cate: $('#category').val(),
            img: $('#img').val(),
            des: $('#video').val(),
        }

        $('#btn-finish').hide();
        insertProduct(product);

    });
    function insertProduct(product) {
        $.ajax({
            method: "POST",
            dataType: "json",
            beforeSend: function (request) {
                request.setRequestHeader("secret", "qwerty");
            },
            url: "admin/edit-product.html",
            data: {
                pro: JSON.stringify(product)
            },
            success: function success(data) {
                if (data.insert == 1)
                    alert('Sửa sản phẩm thành công.');
                else
                    alert('Lỗi !!!!');

                location.reload();
            }
        });
    }

    $('#btn-delete').on('click', function () {

        var product = {
            sn: $('#sn').val(),
            name: $('#name').val(),
            price: $('#price').val(),
            cate: $('#category').val(),
            des: $('#video').val(),
        }

        deleteProduct(product);
    });

    function deleteProduct(product) {
        $.ajax({
            method: "POST",
            dataType: "json",
            beforeSend: function (request) {
                request.setRequestHeader("secret", "qwerty");
            },
            url: "admin/delete-product.html",
            data: {
                pro: JSON.stringify(product)
            },
            success: function success(data) {
                if (data.delete == 1)
                    alert('Xóa sản phẩm thành công.');
                else
                    alert('Lỗi !!!!');

                location.reload();
            }
        });
    }


</script>